# Shipping Pricing Service

–°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏ —Å—Ä–æ–∫–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ä–∑–∏–Ω—ã –∏ –∞–¥—Ä–µ—Å–∞.

**–°—Ç–µ–∫:** Bun, Elysia, TypeScript, PostgreSQL, Redis, Drizzle ORM, Docker.

---

## üöÄ –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
bun install
```

### 2. –°–æ–∑–¥–∞–π `.env`

```env
PORT=3000
NODE_ENV=development

DATABASE_URL=postgres://postgres:postgres@localhost:5432/shipping_db
REDIS_HOST=localhost
REDIS_PORT=6379
```

### 3. PostgreSQL –∏ Redis

```bash
docker run --rm -p 5432:5432   -e POSTGRES_DB=shipping_db   -e POSTGRES_USER=postgres   -e POSTGRES_PASSWORD=postgres   postgres:16

docker run --rm -p 6379:6379 redis:7
```

### 4. –ú–∏–≥—Ä–∞—Ü–∏–∏ + –∑–∞–ø—É—Å–∫

```bash
bun run migrate
bun run dev
```

–ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
curl http://localhost:3000/health
```

---

## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

### –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞

```bash
docker build -t ghcr.io/rodionrostovchshikov/shipping-pricing-service:local .
```

### –ó–∞–ø—É—Å–∫

```bash
docker run --rm -p 3000:3000 --env-file .env   ghcr.io/rodionrostovchshikov/shipping-pricing-service:local
```

---

## üì¶ API

### Health-check

```
GET /health
```

### –†–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–æ—Å—Ç–∞–≤–∫–∏

```
POST /shipping/quotes
Content-Type: application/json
```

---

## üìò Swagger

```
http://localhost:3000/swagger
```

---

## üß™ –¢–µ—Å—Ç—ã

```bash
bun test
```

# –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã

## –ß–∞—Å—Ç—å 3:

–ü–æ –º–æ–µ–º—É –º–Ω–µ–Ω–∏—é, –ø–æ—Å–ª–µ –≤—ã–∫–∞—Ç–∫–∏ —Ñ–∏—á–∏/—Å–µ—Ä–≤–∏—Å–∞, –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º —Ä—è–¥ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –∏ –∑–∞—á–∞—Å—Ç—É—é –ø—Ä–∞–∫—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç,
—á—Ç–æ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ —á–∞—Å—Ç—å –º–µ—Ç—Ä–∏–∫ "–ø—Ä–æ–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è". 

Error rate (% –æ—à–∏–±–æ–∫ –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã), 4xx, 500-—ã–µ –æ—à–∏–±–∫–∏, –ø–∞–¥–µ–Ω–∏—è –≤–æ—Ä–∫–µ—Ä–æ–≤ –∏ —Ä–µ—Å—Ç–∞—Ä—Ç—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –æ—à–∏–±–∫–∏ –≤–Ω–µ—à–Ω–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (–æ—á–µ–Ω—å –≤–∞–∂–Ω—ã!!!) –∫–∞–∫ –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ,
(—Ç–∞–π–º–∞—É—Ç—ã, –æ—à–∏–±–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤), –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–≤—è–∑–∫—É Prometheus + Grafana. –î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ Sentry, Grafana Faro

–£—Å–ø–µ—à–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–±—ã—á–Ω–æ –º–æ–Ω–∏—Ç–æ—Ä—è—Ç —á–µ—Ä–µ–∑ PGWatcher / pg_stat_statements.

–° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è "–ë–∏–∑–Ω–µ—Å–∞", —Ñ–∏—á–∞ –∫–∞–∫ –º–∏–Ω–∏–º—É–º –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏–Ω–æ—Å–∏—Ç—å –ø–æ–ª—å–∑—É –∫–æ–Ω–µ—á–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é,
–∏ —É–ª—É—á—à–∞—Ç—å –±–∏–∑–Ω–µ—Å –º–µ—Ç—Ä–∏–∫–∏ (–≤—ã—Ä—É—á–∫—É, –∫–æ–ª-–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∏ —Ç–¥)

–ü–æ–¥–∫–ª—é—á–∞—é—Ç —Å–µ—Ä–≤–∏—Å—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (Metabase, Mixpanel), —Ç–∞–∫–∂–µ –±–æ–ª—å—à–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞ –∏–º–µ—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ
–º–µ—Ç—Ä–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤ —Ü–µ–ª–æ–º –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ —É–¥–æ–±—Å—Ç–≤–æ –∏ "–±–æ–ª—å".


## –ß–∞—Å—Ç—å 2:

–†–∞—Å—Å—Ç–∞–≤–ª—é —Ç–∞–∫:

1 - –ø—Ä—è–º—ã–µ –¥–µ–Ω—å–≥–∏, —á–∏–Ω—é –Ω–µ–∑–∞–º–µ–¥–ª–∏—Ç–µ–ª—å–Ω–æ –æ–ø–ª–∞—Ç—É

2 - –±–∞–Ω–Ω–µ—Ä —Å —Ä–µ–∫–ª–∞–º–æ–π, –∑–∞–¥–∞—á–∞ –ë–∏–∑–Ω–µ—Å–∞

3 - –ø—Ä–æ–±–ª–µ–º–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –∑–Ω–∞—á–∏—Ç –ø—Ä–æ–±–ª–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–ª–æ–∂–µ–Ω–∞ –Ω–∞ –∫–æ–Ω–µ—Ü, –Ω–µ –≤–ª–∏—è–µ—Ç –∑–¥–µ—Å—å –∏ —Å–µ–π—á–∞—Å

### –ü—Ä–æ–±–ª–µ–º–∞ —Å –æ–ø–ª–∞—Ç–æ–π:

–ü–∏—à—É –≤—Å–µ–º –≤ –ø–µ—Ä–≤—ã–µ –∂–µ –º–∏–Ω—É—Ç—ã, —á—Ç–æ –±–µ—Ä—É –∏–Ω—Ü–∏–¥–µ–Ω—Ç —Å –Ω–µ—É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–æ–π –Ω–∞ —Å–µ–±—è, —Å–æ–æ–±—â–∞—é —á—Ç–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ–∑–∏—Ä—É–µ–º —ç—Ç—É –∑–∞–¥–∞—á—É –∏ —Å–æ–æ–±—â–∞—é –±–∏–∑–Ω–µ—Å—É
(–¥–ª—è —ç—Ç–æ–≥–æ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ –æ–ø–ª–∞—Ç—ã)

–ü–æ—Å–ª–µ –æ—Ü–µ–Ω–∫–∏ –ø—Ä–∏—á–∏–Ω—ã –∏ –ø–ª–∞–Ω–æ–º –¥–µ–π—Å—Ç–≤–∏–π —Å—Ä–∞–∑—É –∂–µ —Å–æ–æ–±—â–∞—é –≤—Ä–µ–º—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã, –¥–∞–±—ã —Å–ª—É–∂–±–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏–º–µ–ª–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–ø–æ–≤–µ—Å—Ç–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤.

–í—ã—è–≤–ª—è—é –æ—à–∏–±–∫—É (—Å—Ç–∞—Ç—É—Å, –≤—Ä–µ–º—è –≤ –ª–æ–≥–∞—Ö, —Ç–∏–ø –æ–ø–ª–∞—Ç—ã –∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∏ –µ–≥–æ –æ—Ç–≤–µ—Ç—ã), —Å–º–æ—Ç—Ä—é –ª–æ–≥–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø—Ä–æ–≤–µ—Ä—è—é –≤—ã–∫–∞—Ç–∫—É –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ä–µ–ª–∏–∑–æ–≤.

### –†–∞–∑–º–µ—â–µ–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞

–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é –æ —Ç–æ–º, —á—Ç–æ –±–µ—Ä—É –∑–∞–¥–∞—á—É –≤ —Ä–∞–±–æ—Ç—É, –Ω–æ –≥–æ–≤–æ—Ä—é –æ —Ç–æ–º, —á—Ç–æ —Å–µ–π—á–∞—Å –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ–ø–ª–∞—Ç–∞–º–∏, –Ω–∞ —á–µ–º
–±–∏–∑–Ω–µ—Å —Ç–µ—Ä—è–µ—Ç 5% –ø–ª–∞—Ç–µ–∂–µ–π, –ø–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞, —Ä–∞–∑–º–µ—Å—Ç–∏–º –±–∞–Ω–Ω–µ—Ä –∏ —É—Å–ø–µ–µ–µ–º –∫ –∞–∫—Ü–∏–∏.

–ü—Ä–µ–¥—É–ø—Ä–µ–¥–∏–≤ –≤—Å–µ—Ö, –¥—É–º–∞—é –ø—Ä–æ–±–ª–µ–º –Ω–µ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç —Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º.

### –†–∞–∑–±–æ—Ä –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º
–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é —á—Ç–æ –±—É–¥—É –∑–∞–Ω—è—Ç –≤ –±–ª–∏–∂–∞–π—à–∏–π —á–∞—Å-–¥–≤–∞, –Ω–æ —Å—Ä–∞–∑—É –ø—Ä–æ—à—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤–≤–æ–¥–Ω—ã–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã.
–ü—Ä–æ—à—É –µ–≥–æ –æ–ø–∏—Å–∞—Ç—å –∫—Ä–∞—Ç–∫–æ –ø—Ä–æ–±–ª–µ–º—É, –ª–æ–≥–∏ –æ—à–∏–±–æ–∫ –≤ –±–∏–ª–¥–µ, —Å–µ—Ä–≤–∏—Å, –µ—Å–ª–∏ –µ—Å—Ç—å Devops –æ—Ç–ø–∏—Å—ã–≤–∞—é—Å—å –µ–º—É, —Å –ø—Ä–æ—Å—å–±–æ–π –≥–ª—è–Ω—É—Ç—å –Ω–∞ –ø–∞–π–ø–ª–∞–π–Ω, –µ—Å–ª–∏ –∂–µ –µ–≥–æ –Ω–µ—Ç



